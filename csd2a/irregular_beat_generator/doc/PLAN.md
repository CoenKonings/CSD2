# Irregular beat generator
The aim is to create a live coding environment that generates beats in two compound meters: 5/4 and 7/8. To enable live coding, the program should play the generated rhythm on a loop while allowing for user input. The user can regenerate (parts of) the rhythm and modulate to a different tempo or to the other of the two compound meters.

## The steps
The steps towards a working prototype are listed here, and described in more detail in the sections below.
1. Allow exporting to MIDI.
2. Allow for user input to generate a new rhythm for one or all of the voices.
3. Edit the rhythm generation algorithm to work for 5/4.
4. Add a parameter to the algorithm that allows the user to select 5/4 or 7/8 meter.
5. Allow modulation between meters.

### Exporting to MIDI
If the user enters the command `export`, the current content of each track should be written to a MIDI file called `rhythm.midi`. Optionally, the user can edit this name by entering a relative path: `export path/to/file.midi`.

### User input to generate a new rhythm for one or all voices
If the user enters the command `regen <part>`, where `<part>` is `low`, `mid`, `high` or `all`, the generation algorithm should be called for the selected track in the sequencer. To enable typing while the rhythm is being played, the program should contain two threads: the main thread is tasked with reading user input, and the other thread is tasked with playing the rhythm.

### Rhythm generation for 5/4
A 5/4 meter indicates that the quarter notes get the beat, and each measure consists of five quarter notes. Usually, this is achieved by dividing the measure into four groups: 3-3-2-2 (eg. the Mission Impossible theme song), or by grouping the two short groups, resulting in a 3-3-4 feel (eg. parts of Lateralus by Tool). By accenting the first of the long, and the first of the short groups, a 5/4 feel can be forced.

The rhythm will be generated by forcing kicks on sixteenth note number 1, and forcing a snare on sixteenth number 7. This will force the 3-3-2-2 or 3-3-4 feel. The hihat, additional kick drums and additional snares will be generated using a 1st order Markov chain.

### Rhythm generation for 7/8
For 7/8 I've decided to take Tool's "Schism" as an example. Here, the eights of the second measure of the main groove are grouped 2-2-3. The feel of the meter can again be created by strategically forcing a kick and a snare, similar to the 5/4 rhythm.

### Allowing modulation between meters
Smooth metric modulation is most often achieved by keeping one part the same and changing the other parts to change the feel of the rhythm. The hihat lends itself especially well for this, since the kick and snare play a more important role when feeling the beat. Metric modulation will be achieved by:
- When going from 7/8 to 5/4, duplicating the final 6 16th notes of the rhythm, and conversely, cutting the final 6 16th notes.
- Generating a new kick pattern in the appropriate meter
- Generating a new snare pattern in the appropriate meter
- At the end of a measure, inserting the new kick, snare and hat pattern into their respective tracks.
